import torch
from datetime import datetime
import numpy as np
import sys
import csv

def execLSTM(hidden, batch_size, timesteps):
	inputs = torch.normal(mean=0.0, std=1.0, size=(timesteps, batch_size, 1))
	inputs = torch.randn(timesteps, batch_size, 1)
	h0 = torch.randn(1, batch_size, hidden)
	c0 = torch.randn(1, batch_size, hidden)
	lstm = torch.nn.LSTM(1,hidden, 1)
	start = datetime.now()
	output, (hn,cn) = lstm(inputs, (h0,c0))
	end = datetime.now()
	elapsed = end - start
	print("{},{},{},{}".format(hidden, batch_size, timesteps, elapsed.microseconds))
	print("output size", output.size())
	print("hn size", hn.size())
	print("cn size", cn.size())

#input_size = 10
#hidden_size=20
#num_layers=2
#seq_len = 5
#batch = 3

def allLSTM_nice():
	execLSTM(64, 64, 100)
	# execLSTM(256, 128, 25)
	# execLSTM(512, 256, 250)
	# execLSTM(1024, 4, 100)
	# execLSTM(1024, 128, 100)
	# execLSTM(64, 1, 25)
	# execLSTM(64, 1, 100)
	# execLSTM(64, 1, 250)
	# execLSTM(64, 1, 1000)
	# execLSTM(64, 1, 2500)
	# execLSTM(64, 1, 5000)
	# execLSTM(64, 2, 25)
	# execLSTM(64, 2, 100)
	# execLSTM(64, 2, 250)
	# execLSTM(64, 2, 1000)
	# execLSTM(64, 2, 2500)
	# execLSTM(64, 2, 5000)
	# execLSTM(64, 4, 25)
	# execLSTM(64, 4, 100)
	# execLSTM(64, 4, 250)
	# execLSTM(64, 4, 1000)
	# execLSTM(64, 4, 2500)
	# execLSTM(64, 4, 5000)
	# execLSTM(64, 16, 25)
	# execLSTM(64, 16, 100)
	# execLSTM(64, 16, 250)
	# execLSTM(64, 16, 1000)
	# execLSTM(64, 16, 2500)
	# execLSTM(64, 16, 5000)
	# execLSTM(64, 32, 25)
	# execLSTM(64, 32, 100)
	# execLSTM(64, 32, 250)
	# execLSTM(64, 32, 1000)
	# execLSTM(64, 32, 2500)
	# execLSTM(64, 32, 5000)
	# execLSTM(64, 64, 25)
	# execLSTM(64, 64, 100)
	# execLSTM(64, 64, 250)
	# execLSTM(64, 64, 1000)
	# execLSTM(64, 64, 2500)
	# execLSTM(64, 64, 5000)
	# execLSTM(64, 128, 25)
	# execLSTM(64, 128, 100)
	# execLSTM(64, 128, 250)
	# execLSTM(64, 128, 1000)
	# execLSTM(64, 128, 2500)
	# execLSTM(64, 128, 5000)
	# execLSTM(64, 256, 25)
	# execLSTM(64, 256, 100)
	# execLSTM(64, 256, 250)
	# execLSTM(64, 256, 1000)
	# execLSTM(64, 256, 2500)
	# execLSTM(64, 256, 5000)
	# execLSTM(256, 1, 25)
	# execLSTM(256, 1, 100)
	# execLSTM(256, 1, 250)
	# execLSTM(256, 1, 1000)
	# execLSTM(256, 1, 2500)
	# execLSTM(256, 1, 5000)
	# execLSTM(256, 2, 25)
	# execLSTM(256, 2, 100)
	# execLSTM(256, 2, 250)
	# execLSTM(256, 2, 1000)
	# execLSTM(256, 2, 2500)
	# execLSTM(256, 2, 5000)
	# execLSTM(256, 4, 25)
	# execLSTM(256, 4, 100)
	# execLSTM(256, 4, 250)
	# execLSTM(256, 4, 1000)
	# execLSTM(256, 4, 2500)
	# execLSTM(256, 4, 5000)
	# execLSTM(256, 16, 25)
	# execLSTM(256, 16, 100)
	# execLSTM(256, 16, 250)
	# execLSTM(256, 16, 1000)
	# execLSTM(256, 16, 2500)
	# execLSTM(256, 16, 5000)
	# execLSTM(256, 32, 25)
	# execLSTM(256, 32, 100)
	# execLSTM(256, 32, 250)
	# execLSTM(256, 32, 1000)
	# execLSTM(256, 32, 2500)
	# execLSTM(256, 32, 5000)
	# execLSTM(256, 64, 25)
	# execLSTM(256, 64, 100)
	# execLSTM(256, 64, 250)
	# execLSTM(256, 64, 1000)
	# execLSTM(256, 64, 2500)
	# execLSTM(256, 64, 5000)
	# execLSTM(256, 128, 25)
	# execLSTM(256, 128, 100)
	# execLSTM(256, 128, 250)
	# execLSTM(256, 128, 1000)
	# execLSTM(256, 128, 2500)
	# execLSTM(256, 128, 5000)
	# execLSTM(256, 256, 25)
	# execLSTM(256, 256, 100)
	# execLSTM(256, 256, 250)
	# execLSTM(256, 256, 1000)
	# execLSTM(256, 256, 2500)
	# execLSTM(256, 256, 5000)
	# execLSTM(512, 1, 25)
	# execLSTM(512, 1, 100)
	# execLSTM(512, 1, 250)
	# execLSTM(512, 1, 1000)
	# execLSTM(512, 1, 2500)
	# execLSTM(512, 1, 5000)
	# execLSTM(512, 2, 25)
	# execLSTM(512, 2, 100)
	# execLSTM(512, 2, 250)
	# execLSTM(512, 2, 1000)
	# execLSTM(512, 2, 2500)
	# execLSTM(512, 2, 5000)
	# execLSTM(512, 4, 25)
	# execLSTM(512, 4, 100)
	# execLSTM(512, 4, 250)
	# execLSTM(512, 4, 1000)
	# execLSTM(512, 4, 2500)
	# execLSTM(512, 4, 5000)
	# execLSTM(512, 16, 25)
	# execLSTM(512, 16, 100)
	# execLSTM(512, 16, 250)
	# execLSTM(512, 16, 1000)
	# execLSTM(512, 16, 2500)
	# execLSTM(512, 16, 5000)
	# execLSTM(512, 32, 25)
	# execLSTM(512, 32, 100)
	# execLSTM(512, 32, 250)
	# execLSTM(512, 32, 1000)
	# execLSTM(512, 32, 2500)
	# execLSTM(512, 32, 5000)
	# execLSTM(512, 64, 25)
	# execLSTM(512, 64, 100)
	# execLSTM(512, 64, 250)
	# execLSTM(512, 64, 1000)
	# execLSTM(512, 64, 2500)
	# execLSTM(512, 64, 5000)
	# execLSTM(512, 128, 25)
	# execLSTM(512, 128, 100)
	# execLSTM(512, 128, 250)
	# execLSTM(512, 128, 1000)
	# execLSTM(512, 128, 2500)
	# execLSTM(512, 128, 5000)
	# execLSTM(512, 256, 25)
	# execLSTM(512, 256, 100)
	# execLSTM(512, 256, 250)
	# execLSTM(512, 256, 1000)
	# execLSTM(512, 256, 2500)
	# # execLSTM(512, 256, 5000)
	# execLSTM(1024, 1, 25)
	# execLSTM(1024, 1, 100)
	# execLSTM(1024, 1, 250)
	# execLSTM(1024, 1, 1000)
	# execLSTM(1024, 1, 2500)
	# # execLSTM(1024, 1, 5000)
	# execLSTM(1024, 2, 25)
	# execLSTM(1024, 2, 100)
	# execLSTM(1024, 2, 250)
	# execLSTM(1024, 2, 1000)
	# execLSTM(1024, 2, 2500)
	# # execLSTM(1024, 2, 5000)
	# execLSTM(1024, 4, 25)
	# execLSTM(1024, 4, 100)
	# execLSTM(1024, 4, 250)
	# execLSTM(1024, 4, 1000)
	# execLSTM(1024, 4, 2500)
	# # execLSTM(1024, 4, 5000)
	# execLSTM(1024, 16, 25)
	# execLSTM(1024, 16, 100)
	# execLSTM(1024, 16, 250)
	# execLSTM(1024, 16, 1000)
	# execLSTM(1024, 16, 2500)
	# # execLSTM(1024, 16, 5000)
	# execLSTM(1024, 32, 25)
	# execLSTM(1024, 32, 100)
	# execLSTM(1024, 32, 250)
	# execLSTM(1024, 32, 1000)
	# execLSTM(1024, 32, 2500)
	# # execLSTM(1024, 32, 5000)
	# execLSTM(1024, 64, 25)
	# execLSTM(1024, 64, 100)
	# execLSTM(1024, 64, 250)
	# execLSTM(1024, 64, 1000)
	# execLSTM(1024, 64, 2500)
	# # execLSTM(1024, 64, 5000)
	# execLSTM(1024, 128, 25)
	# execLSTM(1024, 128, 100)
	# execLSTM(1024, 128, 250)
	# execLSTM(1024, 128, 1000)


allLSTM_nice()